using Newtonsoft.Json;
using Topo.Model.ReportGeneration;
using TopoReportFunction;

namespace TopoReportFunctionTest
{
    [TestClass]
    public class Progress
    {
        private ReportGenerationRequest _reportGenerationRequest;
        private Function _function;

        [TestInitialize]
        public void SetUp()
        {
            _function = new Function();
            _reportGenerationRequest = new ReportGenerationRequest()
            {
                ReportType = ReportType.PersonalProgress,
                GroupName = "Epping Scout Group",
                Section = "scout",
                UnitName = "Scout Unit",
                OutputType = OutputType.PDF,
                ReportData = "{\"Member\":{\"id\":\"a67bb30c-ccdf-38f8-90bf-9364dbe1ca8f\",\"member_number\":\"199991\",\"first_name\":\"Jane\",\"last_name\":\"Jones\",\"status\":\"active\",\"age\":\"18y 9m\",\"unit_council\":false,\"patrol_name\":\"Venturer Patrol\",\"patrol_duty\":\"\",\"patrol_order\":3,\"isAdultLeader\":0,\"selected\":false},\"GroupName\":\"(Epping Scout Group)\",\"IntroToScoutingDate\":\"18/02/15\",\"IntroToSectionDate\":\"23/12/20\",\"Milestones\":[{\"Milestone\":1,\"Status\":\"Awarded\",\"Awarded\":\"2020-12-23T17:44:31.178755+11:00\",\"ParticipateLogs\":[{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Mini Golf\",\"EventDate\":\"2020-02-28T06:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Shakedown Camp\",\"EventDate\":\"2020-11-14T05:00:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Campfire\",\"EventDate\":\"2020-02-07T06:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Wide Game\",\"EventDate\":\"2020-06-26T05:30:00+10:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Beach Night\",\"EventDate\":\"2019-12-21T05:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Rock Climbing\",\"EventDate\":\"2020-08-07T05:31:00+10:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Izzy Backlog from Roselea\",\"EventDate\":\"2020-12-05T02:31:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Izzy Backlog from Roselea\",\"EventDate\":\"2020-12-05T00:30:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Bank Visit\",\"EventDate\":\"2020-12-05T03:00:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Study Skills\",\"EventDate\":\"2020-10-29T18:30:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Scuba Theory P1\",\"EventDate\":\"2020-09-19T05:00:00+10:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Diving Theory P2\",\"EventDate\":\"2020-09-26T05:00:00+10:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Bodybuilding\",\"EventDate\":\"2020-03-13T06:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Pool Party\",\"EventDate\":\"2020-03-20T06:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Chocolate Making\",\"EventDate\":\"2020-02-14T06:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Tent Chase\",\"EventDate\":\"2020-02-21T06:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"RAVE\",\"EventDate\":\"2020-03-06T06:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Card Games\",\"EventDate\":\"2020-04-03T06:30:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Den Cleaning\",\"EventDate\":\"2020-12-02T00:31:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Den Clean Up\",\"EventDate\":\"2020-10-17T22:00:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Geocaching\",\"EventDate\":\"2020-06-19T05:30:00+10:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Meadowbank Boatshed : Official Opening\",\"EventDate\":\"2020-11-21T23:00:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Backlog Community\",\"EventDate\":\"2020-12-05T16:30:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"#stopadani\",\"EventDate\":\"2020-09-18T05:30:00+10:00\"}],\"AssistLogs\":[{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Bushwalk\",\"EventDate\":\"2020-08-09T21:00:00+10:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Mental Health Night\",\"EventDate\":\"2020-10-16T06:30:00+11:00\"}],\"LeadLogs\":[{\"ChallengeArea\":\"creative\",\"EventName\":\"Kahoot\",\"EventDate\":\"2020-03-27T06:30:00+11:00\"}]},{\"Milestone\":2,\"Status\":\"Awarded\",\"Awarded\":\"2021-01-17T13:59:52.655051+11:00\",\"ParticipateLogs\":[{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Abseiling\",\"EventDate\":\"2020-12-11T06:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Canoeing\",\"EventDate\":\"2020-11-19T18:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Backlog Outdoor\",\"EventDate\":\"2020-12-05T14:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Backlog Outdoor\",\"EventDate\":\"2020-12-05T06:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Lose The Vennies Night\",\"EventDate\":\"2020-11-27T06:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Mask Making\",\"EventDate\":\"2020-08-21T05:30:00+10:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Tik Tok Night\",\"EventDate\":\"2020-05-01T05:31:00+10:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Creative Night\",\"EventDate\":\"2020-09-04T05:30:00+10:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Outrageous Origami\",\"EventDate\":\"2020-07-03T05:30:00+10:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Escape Room\",\"EventDate\":\"2020-09-25T05:00:00+10:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Backlog - Personal Growth\",\"EventDate\":\"2020-12-21T00:05:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Backlog - Personal Growth\",\"EventDate\":\"2020-12-22T12:06:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Backlog - Personal Growth\",\"EventDate\":\"2020-12-20T15:30:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Backlog - Personal Growth\",\"EventDate\":\"2020-12-22T15:20:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Backlog - Personal Growth\",\"EventDate\":\"2020-12-20T19:40:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Backlog Community\",\"EventDate\":\"2020-12-07T14:30:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Backlog Community\",\"EventDate\":\"2020-12-05T18:30:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Backlog Community\",\"EventDate\":\"2020-12-07T12:30:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Bunning BBQ\",\"EventDate\":\"2020-12-06T18:30:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Backlog Community\",\"EventDate\":\"2020-12-05T22:31:00+11:00\"}],\"AssistLogs\":[{\"ChallengeArea\":\"community\",\"EventName\":\"Backlog\",\"EventDate\":\"2020-12-21T13:08:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Backlog\",\"EventDate\":\"2020-12-22T22:59:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Muttonbird Island Walk\",\"EventDate\":\"2021-01-14T21:00:00+11:00\"}],\"LeadLogs\":[{\"ChallengeArea\":\"creative\",\"EventName\":\"Backlog\",\"EventDate\":\"2020-12-23T12:06:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Unit Council\",\"EventDate\":\"2020-12-18T05:30:00+11:00\"}]},{\"Milestone\":3,\"Status\":\"Awarded\",\"Awarded\":\"2022-02-03T19:51:04.752368+11:00\",\"ParticipateLogs\":[{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Programming\",\"EventDate\":\"2021-04-22T19:30:00+10:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Backlog - Personal Growth\",\"EventDate\":\"2020-12-22T18:35:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Completion Dinner\",\"EventDate\":\"2021-01-18T05:30:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Badgework Stuff\",\"EventDate\":\"2021-03-05T06:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Ornamental Night\",\"EventDate\":\"2020-12-02T22:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Music Night\",\"EventDate\":\"2020-12-01T18:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Random Night\",\"EventDate\":\"2020-11-05T18:30:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Movie Night\",\"EventDate\":\"2020-12-01T21:30:00+11:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Bunnings BBQ\",\"EventDate\":\"2021-05-30T07:30:00+10:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Messengers of Peace Planning\",\"EventDate\":\"2021-06-10T19:30:00+10:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Bunnings BBQ\",\"EventDate\":\"2021-06-12T07:30:00+10:00\"},{\"ChallengeArea\":\"community\",\"EventName\":\"Earth Tribe Night\",\"EventDate\":\"2021-07-15T19:30:00+10:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Rock Climbing\",\"EventDate\":\"2021-02-12T06:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Observatory Visit\",\"EventDate\":\"2021-01-18T08:01:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Tree Tops\",\"EventDate\":\"2021-01-15T21:00:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Rock Climbing\",\"EventDate\":\"2021-01-21T00:00:00+11:00\"}],\"AssistLogs\":[{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Coffs Harbour\",\"EventDate\":\"2021-01-13T23:03:00+11:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Dubbo\",\"EventDate\":\"2021-01-16T02:00:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Dubbo Zoo\",\"EventDate\":\"2021-01-16T19:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Kayaking and Stand Up Paddleboarding\",\"EventDate\":\"2021-01-17T20:00:00+11:00\"}],\"LeadLogs\":[{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Unit Council\",\"EventDate\":\"2021-02-05T06:30:00+11:00\"},{\"ChallengeArea\":\"outdoors\",\"EventName\":\"Costal Walk\",\"EventDate\":\"2021-01-12T00:00:00+11:00\"},{\"ChallengeArea\":\"creative\",\"EventName\":\"Trivia\",\"EventDate\":\"2021-08-26T19:30:00+10:00\"},{\"ChallengeArea\":\"personal_growth\",\"EventName\":\"Road Trip\",\"EventDate\":\"2021-01-11T17:00:00+11:00\"}]}],\"OASSummaries\":[{\"Stream\":\"aquatics\",\"Stage\":1,\"Awarded\":\"2015-10-07T00:00:00\"},{\"Stream\":\"aquatics\",\"Stage\":2,\"Awarded\":\"2015-10-07T00:00:00\"},{\"Stream\":\"aquatics\",\"Stage\":3,\"Awarded\":\"2015-10-07T00:00:00\"},{\"Stream\":\"aquatics\",\"Stage\":4,\"Awarded\":\"2018-01-31T00:00:00\"},{\"Stream\":\"aquatics\",\"Stage\":4,\"Awarded\":\"2018-01-31T00:00:00\"},{\"Stream\":\"aquatics\",\"Stage\":4,\"Awarded\":\"2020-08-01T16:31:24.796494+10:00\"},{\"Stream\":\"aquatics\",\"Stage\":5,\"Awarded\":\"2021-07-29T20:00:36.951742+10:00\"},{\"Stream\":\"aquatics\",\"Stage\":5,\"Awarded\":\"0001-01-01T00:00:00\"},{\"Stream\":\"aquatics\",\"Stage\":6,\"Awarded\":\"2021-07-29T19:51:13.641809+10:00\"},{\"Stream\":\"boating\",\"Stage\":1,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"boating\",\"Stage\":2,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"boating\",\"Stage\":3,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"boating\",\"Stage\":4,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"boating\",\"Stage\":4,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"bushcraft\",\"Stage\":3,\"Awarded\":\"2020-12-23T18:25:59.892162+11:00\"},{\"Stream\":\"bushcraft\",\"Stage\":4,\"Awarded\":\"2020-12-23T18:25:59.947473+11:00\"},{\"Stream\":\"bushcraft\",\"Stage\":4,\"Awarded\":\"2021-01-12T20:14:07.040653+11:00\"},{\"Stream\":\"bushcraft\",\"Stage\":5,\"Awarded\":\"2021-01-12T20:14:03.178143+11:00\"},{\"Stream\":\"bushcraft\",\"Stage\":5,\"Awarded\":\"2022-04-09T14:57:52.657016+10:00\"},{\"Stream\":\"bushwalking\",\"Stage\":1,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"bushwalking\",\"Stage\":2,\"Awarded\":\"2020-08-01T16:36:14.902746+10:00\"},{\"Stream\":\"bushwalking\",\"Stage\":3,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"bushwalking\",\"Stage\":4,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"bushwalking\",\"Stage\":5,\"Awarded\":\"2021-06-29T12:50:26.885094+10:00\"},{\"Stream\":\"bushwalking\",\"Stage\":6,\"Awarded\":\"2021-07-29T19:58:41.889872+10:00\"},{\"Stream\":\"camping\",\"Stage\":1,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"camping\",\"Stage\":2,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"camping\",\"Stage\":3,\"Awarded\":\"2020-08-01T16:37:45.957388+10:00\"},{\"Stream\":\"camping\",\"Stage\":4,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"camping\",\"Stage\":5,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"camping\",\"Stage\":6,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"camping\",\"Stage\":7,\"Awarded\":\"2021-06-29T12:49:31.643622+10:00\"},{\"Stream\":\"cycling\",\"Stage\":2,\"Awarded\":\"2022-04-20T14:59:24.318146+10:00\"},{\"Stream\":\"cycling\",\"Stage\":3,\"Awarded\":\"2021-01-12T20:14:03.232626+11:00\"},{\"Stream\":\"cycling\",\"Stage\":4,\"Awarded\":\"2021-01-12T20:14:02.233636+11:00\"},{\"Stream\":\"paddling\",\"Stage\":1,\"Awarded\":\"2016-02-28T00:00:00\"},{\"Stream\":\"paddling\",\"Stage\":2,\"Awarded\":\"2016-02-28T00:00:00\"},{\"Stream\":\"paddling\",\"Stage\":3,\"Awarded\":\"2020-08-01T16:33:44.176655+10:00\"},{\"Stream\":\"paddling\",\"Stage\":4,\"Awarded\":\"2016-02-28T00:00:00\"},{\"Stream\":\"paddling\",\"Stage\":4,\"Awarded\":\"0001-01-01T00:00:00\"},{\"Stream\":\"paddling\",\"Stage\":5,\"Awarded\":\"2016-02-28T00:00:00\"},{\"Stream\":\"vertical\",\"Stage\":1,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"vertical\",\"Stage\":2,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"vertical\",\"Stage\":3,\"Awarded\":\"2019-04-03T00:00:00\"},{\"Stream\":\"vertical\",\"Stage\":4,\"Awarded\":\"0001-01-01T00:00:00\"}],\"Stats\":{\"OasProgressions\":13,\"KmsHiked\":100,\"NightsCamped\":10},\"SIASummaries\":[{\"Area\":\"Adventure Sport\",\"Project\":\"Level 3 Referee Course\",\"Status\":\"In Progress\",\"Awarded\":\"2021-06-17T20:42:33.068479+10:00\"},{\"Area\":\"Art Literature\",\"Project\":\"Unit Jersey\",\"Status\":\"Awarded\",\"Awarded\":\"2022-09-11T19:52:37.145623+10:00\"},{\"Area\":\"Better World\",\"Project\":\"Aboriginal and Torres Strait Islander Flags and Acknowledgment of Country\",\"Status\":\"Awarded\",\"Awarded\":\"2022-04-28T20:56:14.897703+10:00\"},{\"Area\":\"Better World\",\"Project\":\"Mardi Gras Dancing\",\"Status\":\"Awarded\",\"Awarded\":\"2022-04-20T14:59:08.572744+10:00\"},{\"Area\":\"Adventure Sport\",\"Project\":\"Learn how to do a rainbow flick\",\"Status\":\"Awarded\",\"Awarded\":\"2022-03-30T16:32:33.871936+11:00\"},{\"Area\":\"Art Literature\",\"Project\":\"Making a bucket hat\",\"Status\":\"Awarded\",\"Awarded\":\"2021-03-04T20:00:41.327805+11:00\"},{\"Area\":\"Environment\",\"Project\":\"The Awesome Weekend of Building Possum Houses so that they can move off of everyone's rooves \",\"Status\":\"Awarded\",\"Awarded\":\"2022-09-08T22:11:32.25731+10:00\"}],\"PeakAward\":{\"PersonalDevelopmentCourse\":\"12/05/22\",\"AdventurousJourney\":\"30/03/22\",\"PersonalReflection\":\"07/10/22\",\"Awarded\":\"09/10/22\"}}"
            };
            if (!Directory.Exists("TestResults"))
                Directory.CreateDirectory("TestResults");
        }

        [TestMethod]
        public void Progress_ToPDF()
        {
            var proxyRequest = new Amazon.Lambda.APIGatewayEvents.APIGatewayProxyRequest();
            proxyRequest.Body = JsonConvert.SerializeObject(_reportGenerationRequest);
            var functionResult = _function.FunctionHandler(proxyRequest, null);
            //Convert Base64String into PDF document
            byte[] bytes = Convert.FromBase64String(functionResult);
            FileStream fileStream = new FileStream(@"TestResults\Progress_ToPDF.pdf", FileMode.Create);
            BinaryWriter writer = new BinaryWriter(fileStream);
            writer.Write(bytes, 0, bytes.Length);
            writer.Close();
        }

    }
}
